var speechUtteranceChunker=function(e,t,n){var c,r;t=t||{},r=speechSynthesis.getVoices().sort(function(e,t){const n=e.name.toUpperCase(),c=t.name.toUpperCase();return n<c?-1:n==c?0:1});var s=t&&void 0!==t.offset?e.text.substring(t.offset):e.text;if(e.voice&&"native"===e.voice.voiceURI)(c=e).text=s,c.addEventListener("end",function(){speechUtteranceChunker.cancel&&(speechUtteranceChunker.cancel=!1),void 0!==n&&n()});else{var o=t&&t.chunkLength||160,i=new RegExp("^[\\s\\S]{"+Math.floor(o/2)+","+o+"}[.!?,]{1}|^[\\s\\S]{1,"+o+"}$|^[\\s\\S]{1,"+o+"} "),a=s.match(i);if(void 0===a[0]||a[0].length<=2)return void(void 0!==n&&n());var h,f=a[0];for(h in(c=new SpeechSynthesisUtterance(f)).lang="en-US",c.volume=1,c.rate=.9,c.voice=r[r.length-1],e)e.hasOwnProperty(h)&&"text"!==h&&(c[h]=e[h]);c.addEventListener("end",function(){speechUtteranceChunker.cancel?speechUtteranceChunker.cancel=!1:(t.offset=t.offset||0,t.offset+=f.length-1,speechUtteranceChunker(e,t,n))})}t.modifier&&t.modifier(c),setTimeout(function(){speechSynthesis.speak(c)},0)};